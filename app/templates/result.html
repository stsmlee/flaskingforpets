{%extends 'base.html'%}

<title>{%block title%}Results{% endblock %}</title>

{%block content%}

<style>
p {
    line-height: 1.5em;
}
</style>

<h1>{{pag['Total number of results']}} Results!</h1>
    {% for pet in res %}
        {% for key, value in pet.items() %}
            {% if key == 'Petfinder Profile Link' %}
                <p><b>{{key}}:</b> <a href="{{value}}">{{pet['Name']}}'s Profile</a></p>
            {% elif key == 'Photos' %}
            <div class = 'flex_pics_container'>
                {% for pic in value %}
                <img src="{{pic}}" alt="photo of {{pet['Name']}}" class = "flex_pics">
                {% endfor %}
            </div>
            {% elif key == 'Published at' %}
                <p id="{{pet['ID']}}"></p>
                <script>
                {
                    const options = {
                        month:'short',
                        day:'numeric',
                        year:'numeric',
                        hour:'numeric',
                        minute:'numeric',
                        timeZoneName: 'short'
                    }
                    let pet_id = '{{ pet["ID"] }}';
                    let old_date = '{{ pet["Published at"] }}';
                    let new_date = new Date(Date.parse(old_date)).toLocaleString([], options);
                    document.getElementById(pet_id).innerHTML = "<b>Published at: </b>" + new_date;
                }
                </script>
            {% else %}
                <p><b>{{key}}:</b> {{value}}</p>
            {% endif %}          
        {% endfor %}
        {% if res.index(pet) != res|length-1 %}
        <hr class="results_hr">
        {% endif %}  
    {% endfor %}

<hr class = "pagination_hr">

<p style="text-align:center;">
    Results per page: {{pag['Results per page']}}<br/>
    Total number of results: {{pag['Total number of results']}}<br/>
    Currently on page {{pag['Current page']}} of {{pag['Total pages']}}<br/>
</p>

<nav class = 'page'>
    {% if pag['Previous'] %}
        <form method="GET" action="{{url_for('search', type=type, payload= payload, page = pag['Current page']-1)}}" style = "display:inline">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="submit" value="Previous" class = 'page_button'>
        </form>
    {% endif %}

    {% if pag['Next'] %}
        <form method="GET" action="{{url_for('search', type=type, payload= payload, page = pag['Current page']+1)}}" style ="display:inline">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="submit" value="Next" class = 'page_button'>
        </form>
    {% endif %}
</nav>

{%endblock%}
